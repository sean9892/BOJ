# [Diamond IV] XOR과 집합과 트리와 쿼리 - 18381 

[문제 링크](https://www.acmicpc.net/problem/18381) 

### 성능 요약

메모리: 16788 KB, 시간: 472 ms

### 분류

자료 구조(data_structures), 유클리드 호제법(euclidean), 최소 공통 조상(lca), 수학(math), 정수론(number_theory), 희소 배열(sparse_table), 트리(trees)

### 문제 설명

<p>양의 정수를 원소로 갖는 유한집합 S에 대해, f(S)를 아래 조건을 만족하는 유한집합 중 가장 크기가 작은 집합으로 정의하며, 이러한 집합은 유일하게 존재한다.</p>

<ul>
	<li>S ⊆ f(S).</li>
	<li>임의의 양의 정수 x, y에 대해 x, y ∈ f(S), x ≠ y이면  x ⊕ y ∈ f(S)이다. (단, ⊕는 Bitwise-XOR)</li>
	<li>임의의 양의 정수 x에 대해 x ∈ f(S)이고 x < 2<sup>1000</sup>이면 2x ∈ f(S)이다.</li>
	<li>임의의 양의 정수 x에 대해 2x ∈ f(S)이고 x < 2<sup>1000</sup>이면 x ∈ f(S)이다.</li>
</ul>

<p>점이 N개인 트리가 있다. 1 ≤ i ≤ N인 모든 i에 대해, i번 정점에는 양의 정수 A<sub>i</sub>가 적혀있다. 이 때, 아래와 같은 Q개의 쿼리를 처리해야 한다.</p>

<p>쿼리 u, v에 대해, u번 정점에서 v번 정점에 이르는 최단경로에 포함되는 점들의 집합을 P라고 하자. 이 때 집합 f({ A<sub>r</sub> | r ∈ P })의 원소 중 최솟값을 출력해야 한다.</p>

### 입력 

 <p>1번째 줄에 정점의 개수 N, 쿼리의 개수 Q가 공백으로 구분되어 주어진다.</p>

<p>2번째 줄에 각 정점에 적힌 양의 정수 A<sub>1</sub>, A<sub>2</sub>, ..., A<sub>N</sub>이 공백으로 구분되어 주어진다.</p>

<p>3번째 줄부터 N - 1개의 줄에 트리의 간선이 연결하는 두 정점의 번호 a, b가 공백으로 구분되어 주어진다.</p>

<p>N + 2번째 줄부터 Q개의 줄에 쿼리를 나타내는 두 정수 u, v가 공백으로 구분되어 주어진다.</p>

### 출력 

 <p>쿼리가 주어질 때마다 쿼리의 답을 한 줄에 하나씩, 총 Q개 줄에 걸쳐 출력한다.</p>

